cat << 'EOF' > start.sh
#!/bin/bash
WEBHOOK="https://discord.com/api/webhooks/1460633815578968239/E5Ck-CCpCwQNUtGXA9z-VpWwcQzZz7M7meSapdb8i7f0cZ_XdnOg4EHeCQ6x4rfmga_2"

# 1. T·∫Øt h·∫øt Pinggy c≈©
pkill -9 pinggy > /dev/null 2>&1
rm -f java.log bedrock.log

# 2. Ch·∫°y l·ªánh
./pinggy -p 443 -R0:127.0.0.1:25565 -o StrictHostKeyChecking=no -o ServerAliveInterval=30 pt70EXJbPWH+tcp@ap.free.pinggy.io > java.log 2>&1 &
./pinggy -p 443 -R0:127.0.0.1:25565 pt70EXJbPWH+udp@ap.free.pinggy.io > bedrock.log 2>&1 &

echo "‚è≥ ƒêang ƒë·ª£i Pinggy c·∫•p IP (c√≥ th·ªÉ m·∫•t t·ªõi 20 gi√¢y)..."

# 3. V√≤ng l·∫∑p ƒë·ª£i Java IP
for i in {1..20}; do
    JAVA_URL=$(grep -oE "[a-z0-9.-]+\.a\.free\.pinggy\.link:[0-9]+" java.log | head -n 1)
    if [ ! -z "$JAVA_URL" ]; then break; fi
    sleep 2
done

# 4. V√≤ng l·∫∑p ƒë·ª£i Bedrock IP
for i in {1..10}; do
    BEDROCK_URL=$(grep -oE "[a-z0-9.-]+\.a\.free\.pinggy\.link:[0-9]+" bedrock.log | head -n 1)
    if [ ! -z "$BEDROCK_URL" ]; then break; fi
    sleep 1
done

# 5. G·ª≠i Discord
if [ ! -z "$JAVA_URL" ]; then
    curl -X POST -H "Content-Type: application/json" -d "{
      \"content\": \"üöÄ **MINECRAFT ONLINE!**\",
      \"embeds\": [{
        \"color\": 65280,
        \"fields\": [
          { \"name\": \"üñ•Ô∏è Java IP\", \"value\": \"\`$JAVA_URL\`\" },
          { \"name\": \"üì± Bedrock IP\", \"value\": \"\`$BEDROCK_URL\`\" }
        ]
      }]
    }" "$WEBHOOK"
    echo "‚úÖ ƒê√£ g·ª≠i Discord: $JAVA_URL"
else
    echo "‚ùå Qu√° th·ªùi gian m√† v·∫´n ch∆∞a l·∫•y ƒë∆∞·ª£c IP. B·∫°n th·ª≠ g√µ 'cat java.log' xem n√≥ b√°o l·ªói g√¨ nh√©."
fi
EOF

chmod +x start.sh
./start.sh
