cat << 'EOF' > start
#!/bin/bash
WEBHOOK="https://discord.com/api/webhooks/1460633815578968239/E5Ck-CCpCwQNUtGXA9z-VpWwcQzZz7M7meSapdb8i7f0cZ_XdnOg4EHeCQ6x4rfmga_2"

# 1. D·ªçn d·∫πp
pkill -9 pinggy > /dev/null 2>&1
rm -f java.log bedrock.log
chmod +x ./pinggy

# 2. Ch·∫°y 2 l·ªánh (D√πng ƒë∆∞·ªùng d·∫´n hi·ªán t·∫°i r√µ r√†ng)
nohup ./pinggy -p 443 -R0:127.0.0.1:25565 -o StrictHostKeyChecking=no -o ServerAliveInterval=30 pt70EXJbPWH+tcp@ap.free.pinggy.io > java.log 2>&1 &
nohup ./pinggy -p 443 -R0:127.0.0.1:25565 pt70EXJbPWH+udp@ap.free.pinggy.io > bedrock.log 2>&1 &

echo "‚è≥ ƒêang k·∫øt n·ªëi Pinggy... (12 gi√¢y)"
sleep 12

# 3. L·ªçc IP (D√πng regex m·∫°nh h∆°n ƒë·ªÉ tr√°nh k√Ω t·ª± r√°c)
JAVA_URL=$(grep -oE "[a-zA-Z0-9.-]+\.a\.free\.pinggy\.link:[0-9]+" java.log | head -n 1)
BEDROCK_URL=$(grep -oE "[a-zA-Z0-9.-]+\.a\.free\.pinggy\.link:[0-9]+" bedrock.log | head -n 1)

# 4. Ki·ªÉm tra v√† g·ª≠i Discord
if [ -n "$JAVA_URL" ]; then
    curl -X POST -H "Content-Type: application/json" -d "{\"content\": \"üöÄ **SERVER ONLINE**\nüñ•Ô∏è Java: \`$JAVA_URL\`\nüì± Bedrock: \`$BEDROCK_URL\`\"}" "$WEBHOOK"
    echo "‚úÖ Xong! Check Discord nh√©."
else
    echo "‚ùå V·∫´n b·ªã l·ªói Killed ho·∫∑c kh√¥ng c√≥ IP."
    echo "--- N·ªòI DUNG LOG JAVA ---"
    cat java.log
fi
EOF

chmod +x start
./start
