cat << 'EOF' > run_mc.sh
#!/bin/bash

WEBHOOK="https://discord.com/api/webhooks/1460633815578968239/E5Ck-CCpCwQNUtGXA9z-VpWwcQzZz7M7meSapdb8i7f0cZ_XdnOg4EHeCQ6x4rfmga_2"

# 1. Cháº¡y Java & Bedrock ngáº§m
./pinggy -p 443 -R0:127.0.0.1:25565 -o StrictHostKeyChecking=no -o ServerAliveInterval=30 pt70EXJbPWH+tcp@ap.free.pinggy.io > java.log 2>&1 &
./pinggy -p 443 -R0:127.0.0.1:25565 pt70EXJbPWH+udp@ap.free.pinggy.io > bedrock.log 2>&1 &

echo "âŒ› Äang láº¥y IP vÃ  gá»­i Discord..."
sleep 10

# 2. Lá»c IP tá»« log
JAVA_IP=$(grep -oE "([a-z0-9.-]+\.a\.free\.pinggy\.link:[0-9]+)" java.log | head -n 1)
BEDROCK_RAW=$(grep -oE "([a-z0-9.-]+\.a\.free\.pinggy\.link:[0-9]+)" bedrock.log | head -n 1)

B_IP=$(echo $BEDROCK_RAW | cut -d':' -f1)
B_PORT=$(echo $BEDROCK_RAW | cut -d':' -f2)

# 3. Gá»­i lÃªn Discord
curl -X POST -H "Content-Type: application/json" -d "{
  \"content\": \"ğŸ® **SERVER MINECRAFT ONLINE!**\",
  \"embeds\": [{
    \"fields\": [
      { \"name\": \"ğŸ–¥ï¸ Java IP\", \"value\": \"\`$JAVA_IP\`\" },
      { \"name\": \"ğŸ“± Bedrock IP\", \"value\": \"\`$B_IP\`\", \"inline\": true },
      { \"name\": \"ğŸ”¢ Port\", \"value\": \"\`$B_PORT\`\", \"inline\": true }
    ],
    \"color\": 5814783
  }]
}" $WEBHOOK

echo "âœ… ÄÃ£ xong! Check Discord cá»§a báº¡n Ä‘i."
EOF

chmod +x run_mc.sh
./run_mc.sh
# --- Gá»¬I DISCORD ---
PAYLOAD=$(cat <<EOF
{
  "embeds": [{
    "title": "ğŸ® SERVER MINECRAFT ASIA ONLINE",
    "description": "Server Ä‘ang cháº¡y á»•n Ä‘á»‹nh trÃªn server ChÃ¢u Ã (Ping tháº¥p)",
    "color": 65280,
    "fields": [
      { "name": "ğŸ–¥ï¸ JAVA EDITION", "value": "\`$JAVA_IP\`" },
      { "name": "ğŸ“± BEDROCK IP", "value": "\`$B_IP\`", "inline": true },
      { "name": "ğŸ”¢ PORT", "value": "\`$B_PORT\`", "inline": true }
    ],
    "footer": { "text": "Cung cáº¥p bá»Ÿi Pinggy Asia Tunnel" }
  }]
}
EOF
)

curl -H "Content-Type: application/json" -X POST -d "$PAYLOAD" $WEBHOOK_URL
echo "âœ… ÄÃ£ gá»­i thÃ´ng tin IP lÃªn Discord thÃ nh cÃ´ng!"
